<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SQL Server | Nilesh Thakkar</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="Nilesh Thakkar">
<link rel="canonical" href="//localhost:1313/tags/sql-server/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d2a1eb8f7c6b93d414a5761b6f17d45a647cc163f0a2fdf76ec650437153a2e8.css" integrity="sha256-0qHrj3xrk9QUpXYbbxfUWmR8wWPwov33bsZQQ3FToug=" rel="preload stylesheet" as="style">
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="//localhost:1313/tags/sql-server/index.xml" title="rss">
<link rel="alternate" hreflang="en" href="//localhost:1313/tags/sql-server/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="//localhost:1313/tags/sql-server/">
  <meta property="og:site_name" content="Nilesh Thakkar">
  <meta property="og:title" content="SQL Server">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SQL Server">
<meta name="twitter:description" content="">

</head>
<body class="list" id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/" accesskey="h" title="Nilesh Thakkar (Alt + H)">Nilesh Thakkar</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/about/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="//localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="//localhost:1313/tags/">Tags</a></div>
  <h1>
    SQL Server
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">How to pass multiple records to stored procedure in Asp.net?
    </h2>
  </header>
  <div class="entry-content">
    <p>There are mainly three ways you can pass multiple records to stored procedure.
Comma delimited string: It is suitable for the scenario where you need to pass single column value XML document : You need to support SQL Server 2005 and you’ve multiple column values. Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance. To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update &#43; insert) logic using Merge Statement, check out an old post here.
...</p>
  </div>
  <footer class="entry-footer"><span title='2012-05-08 01:14:00 +0530 +0530'>May 8, 2012</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to How to pass multiple records to stored procedure in Asp.net?" href="//localhost:1313/2012/05/how-to-pass-multiple-records-to-stored.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Tip: Schema qualify database objects
    </h2>
  </header>
  <div class="entry-content">
    <p>When working in a team, it may happen that few of the team mates follow best practices and others don’t give damn about it. They just completes the tasks on the name of ‘getting things done’. It may create nightmares if all the team members don’t follow the best practices. Either do it or don’t.
Let’s see what can happen with below example.
In one of the project, an SP was created with prefix .dbo and it was working fine until changes came. Now one of the team member made changes and whole team had the feeling “all is well” until that SP was not returning the expected output. So you start debugging your app and consider the following could be the issue.
...</p>
  </div>
  <footer class="entry-footer"><span title='2012-02-13 19:45:00 +0530 +0530'>February 13, 2012</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to Tip: Schema qualify database objects" href="//localhost:1313/2012/02/tip-schema-qualify-database-objects.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Specify size for character data type
    </h2>
  </header>
  <div class="entry-content">
    <p>Recently I was referring books online to confirm one strange behavior in SQL Server. It was like in one of the legacy application, string was passed to stored procedure as parameter and it was storing only 30 characters. To my surprise when I saw the code, everything seem to be ok. Later on found out the problem and fault was while converting parameter to varchar there was no size defined.
...</p>
  </div>
  <footer class="entry-footer"><span title='2012-01-16 22:39:00.001 +0530 +0530'>January 16, 2012</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to Specify size for character data type" href="//localhost:1313/2012/01/specify-size-for-character-data-type.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">SQL Server Add-In : SSMS Tools Pack
    </h2>
  </header>
  <div class="entry-content">
    <p>SSMS Tools Pack, I downloaded this free Add-in 3 weeks ago, and I am glad that I did that. Below are the few features that I’ve been using so far :
SQL Snippets Format SQL New Query Template CRUD Generation Regions and Debug sections You can check out more useful features here and you can download it here.
This add-in makes life easier with its number of features that are missing from SSMS.
...</p>
  </div>
  <footer class="entry-footer"><span title='2011-12-14 23:14:00 +0530 +0530'>December 14, 2011</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to SQL Server Add-In : SSMS Tools Pack" href="//localhost:1313/2011/12/sql-server-add-in-ssms-tools-pack.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Outer joins and search predicates – II
    </h2>
  </header>
  <div class="entry-content">
    <p>In my last post we saw that if we place search predicate in WHERE clause instead of placing it along with ON clause, we may get expected output. Now let’s understand what happens behind the scene.
Note : we&#39;ll use pubs database for the example. Suppose we want to list down all the book titles, then we might write following query.
SELECT T.title\_id as ID, T.Title FROM titles T ORDER BY T.Title Now we are asked to list down sales quantity for any given store for all the titles. If the given title is not sold, the quantity should be zero. For that we might write following query.
...</p>
  </div>
  <footer class="entry-footer"><span title='2011-07-31 15:51:00.002 +0530 +0530'>July 31, 2011</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to Outer joins and search predicates – II" href="//localhost:1313/2011/07/outer-joins-and-search-predicates-ii.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Outer joins and search predicates
    </h2>
  </header>
  <div class="entry-content">
    <p>We often use outer joins to construct queries and get expected output, but what if you get unexpected out and the query seem ok. Few days back I experienced the same thing and found the problem with the placement of predicate (search condition).
Let’s take an example :
We’ll use Orders and Customers table from Northwind database.
Let’s check out INNER JOIN and LEFT JOIN result without any condition first.
...</p>
  </div>
  <footer class="entry-footer"><span title='2011-07-10 17:09:00 +0530 +0530'>July 10, 2011</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to Outer joins and search predicates" href="//localhost:1313/2011/07/outer-joins-and-search-predicates.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Update with join and unexpected output
    </h2>
  </header>
  <div class="entry-content">
    <p>Recently my one of the colleague was writing trigger and in that he’s having Update Query with join, syntax and everything was right but he’s not getting the expected output. To understand the situation let’s take an example.
Create two temporary tables
CREATE TABLE #tmpTable1 ( gid smallint, gBal smallint ) CREATE TABLE #tmpTable2 ( tid smallint, tBal smallint ) Inset following values in both the tables.
insert into #tmpTable1(gid,gBal) values(1, 200), (2,300) insert into #tmpTable2(tid,tBal) values(1, 300), (2,400),(1, 600), (2,700) Now both the table contain inserted values:
...</p>
  </div>
  <footer class="entry-footer"><span title='2010-03-30 23:17:00.001 +0530 +0530'>March 30, 2010</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to Update with join and unexpected output" href="//localhost:1313/2010/03/update-with-join-and-unexpected-output.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">SQL Server 2008 : Table Valued Parameter and Merge
    </h2>
  </header>
  <div class="entry-content">
    <p>Recently I was working on one project and I was supposed to Insert/Update bunch of records in database. I wanted to do it in a single round trip. I Google about it and found out two excellent features of SQL Server 2008: Table Valued Parameter and Merge Statement.
Table Valued Parameter allows you to send bunch of records to database in single round trip. To know how it can be done, please refer this link
...</p>
  </div>
  <footer class="entry-footer"><span title='2009-11-19 22:57:00.006 +0530 +0530'>November 19, 2009</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to SQL Server 2008 : Table Valued Parameter and Merge" href="//localhost:1313/2009/11/sql-server-2008-table-valued-parameter.html"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="//localhost:1313/">Nilesh Thakkar</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
