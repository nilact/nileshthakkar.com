<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Itextsharp | Nilesh Thakkar</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="Nilesh Thakkar">
<link rel="canonical" href="http://localhost:1313/tags/itextsharp/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d2a1eb8f7c6b93d414a5761b6f17d45a647cc163f0a2fdf76ec650437153a2e8.css" integrity="sha256-0qHrj3xrk9QUpXYbbxfUWmR8wWPwov33bsZQQ3FToug=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/tags/itextsharp/index.xml" title="rss">
<link rel="alternate" hreflang="en" href="http://localhost:1313/tags/itextsharp/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/tags/itextsharp/">
  <meta property="og:site_name" content="Nilesh Thakkar">
  <meta property="og:title" content="Itextsharp">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Itextsharp">
<meta name="twitter:description" content="">

</head>
<body class="list" id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Nilesh Thakkar (Alt + H)">Nilesh Thakkar</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/tags/">Tags</a></div>
  <h1>
    Itextsharp
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">iTextSharp: Add dynamic header
    </h2>
  </header>
  <div class="entry-content">
    <p>Note: If you have not gone through my previous post iTextSharp–Add header/footer to PDF , please go through it.
Most of the time we’ll require to print dynamic value in header. i.e. Company Name etc.
You can create properties in PageEvent class that inherits PdfPageEventHelper class.
public class ITextEvents : PdfPageEventHelper { #region Fields private string \_header; #endregion #region Properties public string Header { get { return \_header; } set { \_header = value; } } #endregion public override void OnEndPage(iTextSharp.text.pdf.PdfWriter writer, iTextSharp.text.Document document) { base.OnEndPage(writer, document); iTextSharp.text.Font baseFontNormal = new iTextSharp.text.Font(iTextSharp.text.Font.FontFamily.HELVETICA, 12f, iTextSharp.text.Font.NORMAL, iTextSharp.text.BaseColor.BLACK); Phrase p1Header = new Phrase(Header, baseFontNormal); //Other Code here that adds header. Refer previous article } } Now add below code to your code from where you’re generating PDF:
...</p>
  </div>
  <footer class="entry-footer"><span title='2015-08-18 00:18:00 +0530 +0530'>August 18, 2015</span>&nbsp;·&nbsp;<span>1 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to iTextSharp: Add dynamic header" href="http://localhost:1313/2015/08/itextsharp-add-dynamic-header.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">iTextSharp–Add watermark to PDF
    </h2>
  </header>
  <div class="entry-content">
    <p>In last post iTextSharp–Add header/footer to PDF we saw how to create pdf with header/footer. To add watermark to pdf, you need to create a class that implement IPdfPageEvent as shown in below code:
public class PdfWriterEvents : IPdfPageEvent { string watermarkText = string.Empty; public PdfWriterEvents(string watermark) { watermarkText = watermark; } public void OnStartPage(PdfWriter writer, Document document) { float fontSize = 80; float xPosition = iTextSharp.text.PageSize.A4.Width / 2; float yPosition = (iTextSharp.text.PageSize.A4.Height - 140f) / 2; float angle = 45; try { PdfContentByte under = writer.DirectContentUnder; BaseFont baseFont = BaseFont.CreateFont(BaseFont.HELVETICA, BaseFont.WINANSI, BaseFont.EMBEDDED); under.BeginText(); under.SetColorFill(BaseColor.LIGHT\_GRAY); under.SetFontAndSize(baseFont, fontSize); under.ShowTextAligned(PdfContentByte.ALIGN\_CENTER, watermarkText, xPosition, yPosition, angle); under.EndText(); } catch (Exception ex) { Console.Error.WriteLine(ex.Message); } } public void OnEndPage(PdfWriter writer, Document document) { } public void OnParagraph(PdfWriter writer, Document document, float paragraphPosition) { } public void OnParagraphEnd(PdfWriter writer, Document document, float paragraphPosition) { } public void OnChapter(PdfWriter writer, Document document, float paragraphPosition, Paragraph title) { } public void OnChapterEnd(PdfWriter writer, Document document, float paragraphPosition) { } public void OnSection(PdfWriter writer, Document document, float paragraphPosition, int depth, Paragraph title) { } public void OnSectionEnd(PdfWriter writer, Document document, float paragraphPosition) { } public void OnGenericTag(PdfWriter writer, Document document, Rectangle rect, String text) { } public void OnOpenDocument(PdfWriter writer, Document document) { } public void OnCloseDocument(PdfWriter writer, Document document) { } } Now let’s see how to add watermark using above class:
...</p>
  </div>
  <footer class="entry-footer"><span title='2013-12-31 21:56:00 +0530 +0530'>December 31, 2013</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to iTextSharp–Add watermark to PDF" href="http://localhost:1313/2013/12/itextsharpadd-watermark-to-pdf.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">iTextSharp–Add header/footer to PDF 
    </h2>
  </header>
  <div class="entry-content">
    <p>It’s a common requirement to have header/footer on PDF and it could be achieved using PageEvents in iTextSharp. It depends on the requirement, but in general header may contain:
Header Title Header Subtitle Logo Page Number/Datetime And footer may contain:
Page Number Copyright information Check out below function that creates sample PDF having five pages with header and footer:
private void CreatePDF() { string fileName = string.Empty; DateTime fileCreationDatetime = DateTime.Now; fileName = string.Format(&#34;{0}.pdf&#34;, fileCreationDatetime.ToString(@&#34;yyyyMMdd&#34;) &#43; &#34;\_&#34; &#43; fileCreationDatetime.ToString(@&#34;HHmmss&#34;)); string pdfPath = Server.MapPath(@&#34;~\\PDF\\&#34;) &#43; fileName; using (FileStream msReport = new FileStream(pdfPath, FileMode.Create)) { //step 1 using (Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 140f, 10f)) { try { // step 2 PdfWriter pdfWriter = PdfWriter.GetInstance(pdfDoc, msReport); pdfWriter.PageEvent = new Common.ITextEvents(); //open the stream pdfDoc.Open(); for (int i = 0; i &lt; 5; i&#43;&#43;) { Paragraph para = new Paragraph(&#34;Hello world. Checking Header Footer&#34;, new Font(Font.FontFamily.HELVETICA, 22)); para.Alignment = Element.ALIGN\_CENTER; pdfDoc.Add(para); pdfDoc.NewPage(); } pdfDoc.Close(); } catch (Exception ex) { //handle exception } finally { } } } } Below line assigns object of ItextEvent class that extends PdfPageEventHelper, which contains various methods as shown below that you can override to do various thing like add header/footer, watermark etc. In next post we’ll add watermark using similar class that extends PdfPageEventHelper.
...</p>
  </div>
  <footer class="entry-footer"><span title='2013-11-30 21:55:00.001 +0530 +0530'>November 30, 2013</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to iTextSharp–Add header/footer to PDF " href="http://localhost:1313/2013/11/itextsharpadd-headerfooter-to-pdf.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">iTextSharp–Print PDF
    </h2>
  </header>
  <div class="entry-content">
    <p>To print html page, we use
window.print(); but for PDF same can not be used as it won’t work. However iTextSharp provides a way to print PDF on client side with AddJavaScript method of PdfWriter.
Check out below code:
private void CreatePDF() { string fileName = string.Empty; DateTime fileCreationDatetime = DateTime.Now; fileName = string.Format(&#34;{0}.pdf&#34;, fileCreationDatetime.ToString(@&#34;yyyyMMdd&#34;) &#43; &#34;_&#34; &#43; fileCreationDatetime.ToString(@&#34;HHmmss&#34;)); string pdfPath = @&#34;E:\PDFs\&#34; &#43; fileName; using (FileStream msReport = new FileStream(pdfPath, FileMode.Create)) { //step 1 using (Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 100f, 10f)) { try { // step 2 PdfWriter pdfWriter = PdfWriter.GetInstance(pdfDoc, msReport); //open the stream pdfDoc.Open(); Phrase phrase1 = new Phrase(&#34;Hello world. Checking Print Functionality&#34;); pdfDoc.Add(phrase1); pdfWriter.AddJavaScript(&#34;this.print();&#34;); pdfDoc.Close(); } catch (Exception ex) { //handle exception } finally { } } } } It won’t print the PDF directly but will open print dialog as soon as you open the PDF. One can choose one of the listed printer and print it. There won’t be any print preview. On web page to simulate the print functionality, one can assign pdf path to Iframe which will be hidden on page.
...</p>
  </div>
  <footer class="entry-footer"><span title='2013-09-30 22:36:00 +0530 +0530'>September 30, 2013</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to iTextSharp–Print PDF" href="http://localhost:1313/2013/09/itextsharpprint-pdf.html"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">iTextSharp - Add Image from base64 string
    </h2>
  </header>
  <div class="entry-content">
    <p>Itexhsharp is one of the popular third party component to create PDF with .Net framework.
If you’re using Itextsharp for the very first time, I would suggest you to go through Mike’s series on Itextsharp that helps you to get started and here is the article from the series that shows different ways to add images to Itextsharp.
To add image from base64 string, you first need to convert base64 string in to bytes array and then you can call GetInstance method of Itextsharp Image which accepts bytes array.
...</p>
  </div>
  <footer class="entry-footer"><span title='2013-03-17 22:53:00 +0530 +0530'>March 17, 2013</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span></footer>
  <a class="entry-link" aria-label="post link to iTextSharp - Add Image from base64 string" href="http://localhost:1313/2013/03/itextsharp-add-image-from-base64-string.html"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Nilesh Thakkar</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
