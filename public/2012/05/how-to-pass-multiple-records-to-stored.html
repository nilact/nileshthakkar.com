<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How to pass multiple records to stored procedure in Asp.net? | Nilesh Thakkar</title>
<meta name="keywords" content="tsql, XML, SQL Server, Asp.net">
<meta name="description" content="There are mainly three ways you can pass multiple records to stored procedure.

Comma delimited string:  It is suitable for the scenario where you need to pass single column value
XML document : You need to support SQL Server 2005 and you’ve multiple column values.
Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance.

To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update &#43; insert) logic using Merge Statement, check out an old post here.">
<meta name="author" content="Nilesh Thakkar">
<link rel="canonical" href="http://localhost:1313/2012/05/how-to-pass-multiple-records-to-stored.html">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d2a1eb8f7c6b93d414a5761b6f17d45a647cc163f0a2fdf76ec650437153a2e8.css" integrity="sha256-0qHrj3xrk9QUpXYbbxfUWmR8wWPwov33bsZQQ3FToug=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/2012/05/how-to-pass-multiple-records-to-stored.html">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/2012/05/how-to-pass-multiple-records-to-stored.html">
  <meta property="og:site_name" content="Nilesh Thakkar">
  <meta property="og:title" content="How to pass multiple records to stored procedure in Asp.net?">
  <meta property="og:description" content="There are mainly three ways you can pass multiple records to stored procedure.
Comma delimited string: It is suitable for the scenario where you need to pass single column value XML document : You need to support SQL Server 2005 and you’ve multiple column values. Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance. To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update &#43; insert) logic using Merge Statement, check out an old post here.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2012-05-08T01:14:00+05:30">
    <meta property="article:modified_time" content="2012-05-08T01:14:00+05:30">
    <meta property="article:tag" content="Tsql">
    <meta property="article:tag" content="XML">
    <meta property="article:tag" content="SQL Server">
    <meta property="article:tag" content="Asp.net">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to pass multiple records to stored procedure in Asp.net?">
<meta name="twitter:description" content="There are mainly three ways you can pass multiple records to stored procedure.

Comma delimited string:  It is suitable for the scenario where you need to pass single column value
XML document : You need to support SQL Server 2005 and you’ve multiple column values.
Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance.

To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update &#43; insert) logic using Merge Statement, check out an old post here.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How to pass multiple records to stored procedure in Asp.net?",
      "item": "http://localhost:1313/2012/05/how-to-pass-multiple-records-to-stored.html"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How to pass multiple records to stored procedure in Asp.net?",
  "name": "How to pass multiple records to stored procedure in Asp.net?",
  "description": "There are mainly three ways you can pass multiple records to stored procedure.\nComma delimited string: It is suitable for the scenario where you need to pass single column value XML document : You need to support SQL Server 2005 and you’ve multiple column values. Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance. To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update + insert) logic using Merge Statement, check out an old post here.\n",
  "keywords": [
    "tsql", "XML", "SQL Server", "Asp.net"
  ],
  "articleBody": "There are mainly three ways you can pass multiple records to stored procedure.\nComma delimited string: It is suitable for the scenario where you need to pass single column value XML document : You need to support SQL Server 2005 and you’ve multiple column values. Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance. To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update + insert) logic using Merge Statement, check out an old post here.\nWe’ll see in this post how you can pass XML document to stored procedure and parse it in stored procedure and insert into table.\nFirst of all let’s check out how you can generate XML Document in Asp.net using XmlSerializer.\nLet’s say we’ve list of Person and we want to serealize it to xml then do as below:\nList people = new List { new Person { FirstName = \"Scott\", LastName = \"Guthrie\", Age = 32 }, new Person { FirstName = \"Bill\", LastName = \"Gates\", Age = 50 }, new Person { FirstName = \"Susanne\", LastName = \"Guthrie\", Age = 32 } }; string strXML = SerializeObject",
  "wordCount" : "559",
  "inLanguage": "en",
  "datePublished": "2012-05-08T01:14:00+05:30",
  "dateModified": "2012-05-08T01:14:00+05:30",
  "author":{
    "@type": "Person",
    "name": "Nilesh Thakkar"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/2012/05/how-to-pass-multiple-records-to-stored.html"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Nilesh Thakkar",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Nilesh Thakkar (Alt + H)">Nilesh Thakkar</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      How to pass multiple records to stored procedure in Asp.net?
    </h1>
    <div class="post-meta"><span title='2012-05-08 01:14:00 +0530 +0530'>May 8, 2012</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>Nilesh Thakkar</span>

</div>
  </header> 
  <div class="post-content"><p>There are mainly three ways you can pass multiple records to stored procedure.</p>
<ul>
<li>Comma delimited string:  It is suitable for the scenario where you need to pass single column value</li>
<li>XML document : You need to support SQL Server 2005 and you’ve multiple column values.</li>
<li>Table valued parameter : You’ve SQL Server 2008 and you don’t want to get into parsing stuff at the backend and want the best performance.</li>
</ul>
<p>To know what is table valued parameter and how to pass datatable to stored procedure and implement upsert (update + insert) logic using Merge Statement, check out an old post <a href="http://nilthakkar.blogspot.in/2009/11/sql-server-2008-table-valued-parameter.html">here</a>.</p>
<p>We’ll see in this post how you can pass XML document to stored procedure and parse it in stored procedure and insert into table.</p>
<p>First of all let’s check out how you can generate XML Document in Asp.net using <a href="http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer%28v=vs.90%29.aspx">XmlSerializer</a>.</p>
<p>Let’s say we’ve list of Person and we want to serealize it to xml then do as below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>List&lt;Person&gt; people = <span style="color:#66d9ef">new</span> List&lt;Person&gt; {
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Scott&#34;</span>, LastName = <span style="color:#e6db74">&#34;Guthrie&#34;</span>, Age = <span style="color:#ae81ff">32</span> },
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Bill&#34;</span>, LastName = <span style="color:#e6db74">&#34;Gates&#34;</span>, Age = <span style="color:#ae81ff">50</span> },
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">new</span> Person { FirstName = <span style="color:#e6db74">&#34;Susanne&#34;</span>, LastName = <span style="color:#e6db74">&#34;Guthrie&#34;</span>, Age = <span style="color:#ae81ff">32</span> }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">string</span> strXML = SerializeObject&lt;List&lt;Person&gt;&gt;(people);
</span></span></code></pre></div><p>And the function that serialize the object to XML is as below :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> SerializeObject&lt;T&gt;(T Obj)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> strxml = <span style="color:#66d9ef">string</span>.Empty;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">using</span> (StringWriter sw = <span style="color:#66d9ef">new</span> StringWriter())
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        XmlSerializer xs = <span style="color:#66d9ef">new</span> XmlSerializer(<span style="color:#66d9ef">typeof</span>(T));
</span></span><span style="display:flex;"><span>        xs.Serialize(sw, Obj);
</span></span><span style="display:flex;"><span>        strxml = sw.ToString();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> strxml;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And the resultant XML would be as below :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-16&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;ArrayOfPerson</span> <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#a6e22e">xmlns:xsd=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;Person&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;FirstName&gt;</span>Scott<span style="color:#f92672">&lt;/FirstName&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;LastName&gt;</span>Guthrie<span style="color:#f92672">&lt;/LastName&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;Age&gt;</span>32<span style="color:#f92672">&lt;/Age&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Person&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;Person&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;FirstName&gt;</span>Bill<span style="color:#f92672">&lt;/FirstName&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;LastName&gt;</span>Gates<span style="color:#f92672">&lt;/LastName&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;Age&gt;</span>50<span style="color:#f92672">&lt;/Age&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Person&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;Person&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;FirstName&gt;</span>Susanne<span style="color:#f92672">&lt;/FirstName&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;LastName&gt;</span>Guthrie<span style="color:#f92672">&lt;/LastName&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;Age&gt;</span>32<span style="color:#f92672">&lt;/Age&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Person&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/ArrayOfPerson&gt;</span>
</span></span></code></pre></div><p>Generated XML is having encoding UTF-16. Now pass above xml to your stored procedure as shown below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">string</span> connectionString = Convert.ToString(ConfigurationManager.ConnectionStrings[<span style="color:#e6db74">&#34;XMLDBConnString&#34;</span>]);          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> (SqlConnection cn = <span style="color:#66d9ef">new</span> SqlConnection(connectionString))
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">using</span> (SqlCommand cm = <span style="color:#66d9ef">new</span> SqlCommand(<span style="color:#e6db74">&#34;SaveUser&#34;</span>, cn))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        cm.CommandType = CommandType.StoredProcedure;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        cm.Parameters.Add(<span style="color:#e6db74">&#34;@UsersXml&#34;</span>, SqlDbType.NVarChar, -<span style="color:#ae81ff">1</span>).Value = strXML;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        cn.Open();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        cm.ExecuteNonQuery();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If you see the parameter datatype, it is Nvarchar as generated XML is having encoding UTF-16. If you need to support Unicode characters then you don’t need to change anything or you need to encode to UTF-8, then you can use UTF8StringWriter class  shown below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Utf8StringWriter</span> : StringWriter
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> Encoding Encoding
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> Encoding.UTF8; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Note : If you pass XML having enconding UTF-16 with varchar datatype to  stored procedure, it will throw error : <strong>unable to switch the encoding</strong></p>
<p>To avoid error either use Utf8StringWriter class instead of StringWriter and use varchar datatype or use nvarchar datatype and pass xml with encoding UTF-16.</p>
<p>Now to parse generated element centric xml we need to use Xquery. If you’re new to Xquery, I would suggest you go through below links or you can skip them if you wish.</p>
<p><a href="http://www.w3schools.com/xpath/xpath_syntax.asp">Xpath Syntax</a><br>
<a href="http://www.playwithsql.com/2011/12/get-table-from-xml.html">Get Table From XML</a></p>
<p>Check out sample stored procedure :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SET</span> ANSI_NULLS <span style="color:#66d9ef">ON</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GO</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SET</span> QUOTED_IDENTIFIER <span style="color:#66d9ef">ON</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GO</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ALTER</span> <span style="color:#66d9ef">PROCEDURE</span> [dbo].[SaveUser]
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">@</span>UsersXml <span style="color:#66d9ef">AS</span> NVARCHAR(<span style="color:#66d9ef">MAX</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">AS</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">BEGIN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">DECLARE</span> <span style="color:#f92672">@</span>XML <span style="color:#66d9ef">AS</span> XML
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">@</span>XML <span style="color:#f92672">=</span> <span style="color:#f92672">@</span>UsersXml
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Person (FirstName, LastName, Age)      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">select</span> M.Item.value(<span style="color:#e6db74">&#39;FirstName[1]&#39;</span>,<span style="color:#e6db74">&#39;VARCHAR(50)&#39;</span>),
</span></span><span style="display:flex;"><span>    M.Item.value(<span style="color:#e6db74">&#39;LastName[1]&#39;</span>,<span style="color:#e6db74">&#39;Varchar(50)&#39;</span>),
</span></span><span style="display:flex;"><span>    M.Item.value(<span style="color:#e6db74">&#39;Age[1]&#39;</span>,<span style="color:#e6db74">&#39;INT&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">FROM</span> <span style="color:#f92672">@</span>xml.nodes(<span style="color:#e6db74">&#39;/ArrayOfPerson/Person&#39;</span>) <span style="color:#66d9ef">AS</span> M(Item)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span>
</span></span></code></pre></div><p>Note : XQuery is case-sensitive, hence check your tsql statements for typo if you don’t get expected output.</p>
<p>That’s all you need, I hope it helps! Your comments are most welcome. :)</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/tsql/">Tsql</a></li>
      <li><a href="http://localhost:1313/tags/xml/">XML</a></li>
      <li><a href="http://localhost:1313/tags/sql-server/">SQL Server</a></li>
      <li><a href="http://localhost:1313/tags/asp.net/">Asp.net</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/2013/03/itextsharp-add-image-from-base64-string.html">
    <span class="title">« Prev</span>
    <br>
    <span>iTextSharp - Add Image from base64 string</span>
  </a>
  <a class="next" href="http://localhost:1313/2012/03/edit-share-execute-and-debug-code.html">
    <span class="title">Next »</span>
    <br>
    <span>Edit, share, execute and debug code within browser - make a fiddle</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on x"
            href="https://x.com/intent/tweet/?text=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f&amp;url=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html&amp;hashtags=tsql%2cXML%2cSQLServer%2cAsp.net">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html&amp;title=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f&amp;summary=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f&amp;source=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html&title=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on whatsapp"
            href="https://api.whatsapp.com/send?text=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f%20-%20http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on telegram"
            href="https://telegram.me/share/url?text=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f&amp;url=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share How to pass multiple records to stored procedure in Asp.net? on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=How%20to%20pass%20multiple%20records%20to%20stored%20procedure%20in%20Asp.net%3f&u=http%3a%2f%2flocalhost%3a1313%2f2012%2f05%2fhow-to-pass-multiple-records-to-stored.html">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Nilesh Thakkar</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
